<!doctype html>
<html>
<head> 
<!-- link to main stylesheet -->
<link rel="stylesheet" type="text/css" href="/css/main.css">
</head> 
<body>
  
  <h1>French election results</h1>
	
  <pre>
  <code>
import delimited Z:\home\me\RG15T1_ok.txt, delimiter(";") 
gen str3 com = string(codcom,"%03.0f")
egen insee = concat( coddep com)
destring bv, gen(bv2) force
egen idbv = concat( insee bv)
drop if bv2 ==.

// RG 2015

gen lcom = voix if nuance =="LCOM"
gen ldiv = voix if nuance =="LDIV"
gen ldlf = voix if nuance =="LDLF"
gen ldvd = voix if nuance =="LDVD"
gen ldvg = voix if nuance =="LDVG"
gen leco= voix if nuance =="LECO"
gen lexd = voix if nuance =="LEXD"
gen lexg = voix if nuance =="LEXG"
gen lfg = voix if nuance =="LFG"
gen lfn = voix if nuance =="LFN"
gen llr = voix if nuance =="LLR"
gen lmdm = voix if nuance =="LMDM"
gen lrdg = voix if nuance =="LRDG"
gen lreg = voix if nuance =="LREG"
gen lsoc = voix if nuance =="LSOC"
gen lud = voix if nuance =="LUDI"
gen lug = voix if nuance =="LUG"
gen lvec = voix if nuance =="LVEC"
gen lveg = voix if nuance =="LVEG"

foreach x of varlist(lcom-lveg) {
bysort idbv: egen t_`x' = total(`x')
}

keep coddep codcom libcom bv bv2 ins vot com insee idbv t_lcom-t_lveg

duplicates drop

/// Boucles bureau

gen bn = vot - ( t_lcom + t_ldiv + t_ldlf + t_ldvd + t_ldvg + t_leco + t_lexd + t_lexg + t_lfg + t_lfn + t_llr + t_lmdm + t_lrdg + t_lreg + t_lsoc + t_lud + t_lug + t_lvec + t_lveg)
gen exp = vot - bn 

foreach x of varlist(t_lcom-t_lveg) {
gen i_`x' = `x' / ins * 100
}

foreach x of varlist(t_lcom-t_lveg) {
gen e_`x' = `x' / exp * 100
}

/// Boucles commune

foreach x of varlist(ins vot exp bn t_lcom-t_lveg) {
bysort insee : egen com_`x' = total(`x')
}

foreach x of varlist(com_t_lcom-com_t_lveg) {
gen i_`x' = `x' / com_ins * 100
}

foreach x of varlist(com_t_lcom-com_t_lveg) {
gen e_`x' = `x' / com_exp * 100
}

keep coddep codcom libcom insee com_ins com_vot com_bn com_exp com_t_lcom-e_com_t_lveg

duplicates drop
  </code>
  </pre>
	
  <p>ESS Frequent recode</p>
  
  <pre>
  <code>
  recode rlgdnm (1=1 "Catholic") (2=2 "Protestant") (3/4=3 "Other christian") (5=4 "Jewish") (6/8=5 "Islamic & other")  (66=6 "No religion") (77/99=.), gen(relig)
  recode rlgdgr (0=0 "not religious") (1/4 = 1 "low religiosity") (5/7 = 2 "medium reliosity") (8/10 = 3 "high religiosity") (else=.), gen(religiosity)
  recode lrscale (0/4 = 1 "left") (5=2 "nini") (6/10=3 "right") (else =4 "no place"), gen(placement)
  recode agea (15/24 = 1 "15-24 ans") (25/34= 2 "25-34 ans") (35/44= 3 "35-44 ans") (45/54= 4 "45-54 ans") (55/64 = 5 "55/64 ans") (65/100 = 6 "65 ans et plus") (else = .),gen (agecod)
  recode agea (18/24 = 1 "18-24 ans") (25/34= 2 "25-34 ans") (35/44= 3 "35-44 ans") (45/54= 4 "45-54 ans") (55/64 = 5 "55/64 ans") (65/100 = 6 "65 ans et plus") (else = .),gen (agecod)
  recode eisced (1=1 "isced 1") (2=2 "isced 2") (3=3 "isced 3b") (4=4 "isced 3a") (5=5 "isced 4") (6=5 "isced 5a") (7=6 "isced 5b") (else=.), gen(educ)
  recode gndr (1=1 "Male") (2=2 "Female") (9=.), gen(sex)
  recode isco08 (0/999 = 0 "Armed forces") (1000/1999 = 1 "Managers") (2000/2999 = 2 "Professionals") (3000/3999 = 3 "Technicians") ///
  (4000/4999 = 4 "Clercks") (5000/5999 = 5 "Services") (6000/6999 = 6 "Skilled Agri") (7000/7999 = 7 "Craft & trade")               ///
  (8000/8999 = 8 "Plant operators") (9000/9999 = 9 "Elementary occ") (else= 10 "inactive") , gen(class)

  recode aesfdrk (1=1 "Very safe") (2=2 "Safe") (3=3 "Unsafe") (4=4 "Very unsafe") (7/9=.), gen(safety)
  recode crmvct (1=1 "yes") (2=0 "no") (else=.), gen(victim)
    
  gen w  = dweight * pweight
  gen w2 = w * 100000
  gen w3 = round(w2)
  </code>
  </pre>

</body>
</html>

  
